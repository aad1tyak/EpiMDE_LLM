# LLM-Driven Epidemiological Model Generation (Supplementary Material)

This repository contains the source code for the LLM-driven pipeline designed for generating epidemiological models in XML format, as described in the accompanying research paper. It serves as supplementary material to allow reviewers and researchers to reproduce the experimental results and explore the methodology.

## 1. Project Overview

This project implements a two-stage Large Language Model (LLM) pipeline to transform multimodal inputs (epidemiological diagrams and structured tabular data) into a standardized SEIR model XML format. The pipeline leverages an LLM (specifically, Google's Gemini 2.5 Pro) for both structural generation and precise parameter computation, guided by a formal metamodel.

For a detailed understanding of the methodology, evaluation, and experimental results, please refer to the main research paper.

## 2. Repository Contents

* `main.py`: The core script that orchestrates the two-stage LLM pipeline.
* `diagrams/`: This folder is intended for epidemiological model diagrams (e.g., `.png`, `.jpeg`). An example diagram used in the paper, `simple_sir_diagram.png` (or `image_aace1a.png` if that's the one you're using for SIR), would reside here. You would place other model diagrams (e.g., for COVID-19, HIV) in this directory.
* `metamodel.json`: Defines the strict XML structure and validation rules for the SEIR models.
* `seirmodel_skeleton.txt`: A template illustrating the expected XML output structure.
* `model_inputs/`: This directory contains the tabular data inputs for the different epidemiological models used in the study.
    * `simple_sir_data.txt`: Tabular data for the Simple SIR model.
    * `covid_data.txt`: Tabular data for the COVID-19 model.
    * `hiv_data.txt`: Tabular data for the HIV model.
* `prompt_sample/`: This directory will store the output XML files generated by the pipeline, including the full LLM interaction logs.
* `.env.example`: An example file for setting up your API key.
* `requirements.txt`: Lists all Python dependencies required to run the project.

## 3. Setup and Installation

To get started with the project, follow these steps:

1.  **Clone the Repository:**
    ```bash
    git clone [https://github.com/YourAnonymousRepo/EpiMDE-LLM-Project.git](https://github.com/YourAnonymousRepo/EpiMDE-LLM-Project.git)
    cd EpiMDE-LLM-Project
    ```
    *(Note: Replace `YourAnonymousRepo/EpiMDE-LLM-Project` with the actual anonymous repository URL provided by the conference/journal platform.)*

2.  **Install Python Dependencies:**
    It is highly recommended to use a virtual environment.
    ```bash
    python3 -m venv venv
    source venv/bin/activate
    pip install -r requirements.txt
    ```
    The `requirements.txt` file is expected to contain:
    ```
    google-generativeai
    python-dotenv
    Pillow
    ```

3.  **Set Up Google Gemini API Key:**
    * Obtain a Google Gemini API key from [Google AI Studio](https://aistudio.google.com/app/apikey).
    * Create a file named `.env` in the root directory of your cloned repository (the same directory as `main.py`).
    * Add your API key to this file in the following format:
        ```
        GOOGLE_API_KEY="your_api_key_here"
        ```
    * **Important:** Do not commit your `.env` file to the repository. It's already in `.gitignore` if you initialized correctly.

## 4. How to Run

The `main.py` script facilitates the generation of SEIR models. You can execute it from your terminal.

### Running a Specific Model

The `generate_seirmodel_from_image` function in `main.py` is the primary entry point. You will need to uncomment or add calls within `main.py` to run specific models.

1.  **Ensure your model diagrams are in the `diagrams/` folder.**
    For instance, for the Simple SIR model, ensure `simple_sir_diagram.png` (or `image_aace1a.png` if that's your reference image) is in `diagrams/`.

2.  **Prepare the `user_input` data.**
    The provided `model_inputs/` folder contains pre-formatted strings (`simple_sir_data.txt`, `covid_data.txt`, `hiv_data.txt`) that are passed as `user_input` to the function. For execution, you would load these into a variable in `main.py`.

3.  **Example Usage in `main.py`:**
    You can add a section at the bottom of your `main.py` like this to trigger the generation:

    ```python
    # Example: Running the Simple SIR model
    print("Generating Simple SIR model...")
    with open(os.path.join(os.path.dirname(__file__), "model_inputs", "simple_sir_data.txt"), "r", encoding="utf-8") as f:
        simple_sir_user_input = f.read()

    # Assuming 'simple_sir_diagram.png' is your image for SIR model
    generate_seirmodel_from_image("simple_sir_diagram.png", simple_sir_user_input, "simple_sir_output.xml")
    print("Simple SIR model generation complete.")

    # Example: Running the COVID-19 model
    print("\nGenerating COVID-19 model...")
    with open(os.path.join(os.path.dirname(__file__), "model_inputs", "covid_data.txt"), "r", encoding="utf-8") as f:
        covid_user_input = f.read()
    # Assuming 'covid_diagram.png' is your image for COVID model
    generate_seirmodel_from_image("covid_diagram.png", covid_user_input, "covid_output.xml")
    print("COVID-19 model generation complete.")

    # Example: Running the HIV model
    print("\nGenerating HIV model...")
    with open(os.path.join(os.path.dirname(__file__), "model_inputs", "hiv_data.txt"), "r", encoding="utf-8") as f:
        hiv_user_input = f.read()
    # Assuming 'hiv_diagram.png' is your image for HIV model
    generate_seirmodel_from_image("hiv_diagram.png", hiv_user_input, "hiv_output.xml")
    print("HIV model generation complete.")
    ```

4.  **Execute the Script:**
    ```bash
    python3 main.py
    ```

### Output

Upon successful execution, generated XML files and interaction logs will be saved in the `prompt_sample/` directory within your project folder. These files contain the final SEIR model XML as well as the intermediate LLM prompts and responses.

## 5. Anonymity Note for Reviewers

This repository has been anonymized for peer review. No identifying information about the authors or institutions is included. Please refer to the main research paper for full author details.

## 6. License

This project is open-sourced under the MIT License. See the `LICENSE` file for more details.

---